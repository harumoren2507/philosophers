** スレッドとは




前提知識



**プロセス

OSが実行しているプログラムのインスタンス。= 「実行中のプログラム」とほぼほぼみなしていい。
各プロセスは独自のメモリ空間を持ち、他のプロセスとは隔離されている。

例:複数のブラウザタブがそれぞれ異なるプロセスで動作することで、あるタブがクラッシュしても他のタブに影響しない。


プロセスはプログラムの実行に必要な様々なリソースを管理する。

***コードセグメント（実行可能なコード）
***データセグメント（グローバル変数や静的変数）
***ヒープ（動的メモリ割り当て）
***スタック（ローカル変数、関数パラメータ、関数呼び出し）
***レジスタ（CPU の高速な一時的データ格納場所）

https://storage.googleapis.com/zenn-user-upload/10af168f6275-20240427.png

参考記事の詳細
https://zenn.dev/farstep/articles/process-thread-difference



**スレッド

スレッド(thread)とは、プロセス内部に含まれている論理的な並列処理の単位。
かんたんに言うと、スレッドとは“仕事”のこと。

プログラムを起動すると、必ず1つのスレッドが生成される。
具体的に言うと、C言語のプログラムの場合はmain関数を実行するというスレッド(仕事)が生成される。
このスレッドをmainスレッドと呼ぶことがある。


余談

スレッド(仕事)をするのがCPUのコアである。
スレッドを"仕事"として例えるなら、コアは"仕事をする人"である。

コンピュータの脳を司るCPUには複数のコアが搭載されている。
つまり、仕事をする人が複数いることになり、同時に複数の仕事をこなすことが可能である。

CPUのスペック表を見ると、コア数と一緒にスレッド数が記載されているケースが多い。

例えば、コア数が4つなのに、スレッド数が8の場合は1つのコアが2つの仕事(スレッド)を理論上処理できることになる。
https://daeudaeu.com/wp-content/uploads/2019/04/multirhread_11.png

ただし、スレッド1つに対して動作するコアはせいぜい1つだけ。
マルチスレッドプログラミングを行わない限り、実行時に生成されるスレッド(仕事)は基本的に1つだけ。
そのため、コアが複数有っても、コアを1つしか使用しないプログラムになることが大半である。

余っているコアに仕事をさせるために仕事を小さな単位に分割して、サボっているコアに仕事を割り振るというのが
「マルチスレッド処理」の考え方である。

具体的には、マルチスレッドというのは、仕事（スレッド）を複数の仕事に分割した細分化された仕事です。

これによってサボっているコアを有効活用することができ、仕事を完了させるのに必要pな時間を短縮させることが可能になる。


シングルスレッドの図
https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F274121%2F8d5eda73-0d9a-0ab0-529c-d90be3773d2d.jpeg?ixlib=rb-4.0.0&auto=format&gif-q=60&q=75&w=1400&fit=max&s=64614ffda9b2f29eb8b9ed1e9d02351f

マルチスレッドの図
https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F274121%2F7c78a3d3-daf3-621e-a5b1-d35ab8154c6e.jpeg?ixlib=rb-4.0.0&auto=format&gif-q=60&q=75&w=1400&fit=max&s=9fce377749a2f10ccb48f8cc34e6ccde



***疑問一覧

通常のプログラムやforkなどでプロセスを生成されたとき、それぞれのプロセスには1つのスレッドしか内蔵されていないのか？
今の認識では、複数スレッドを生成し扱うには専用関数が必要なイメージ。

A:通常のプログラム実行やforkなどでプロセスが生成された時点では、基本的に1つのスレッドしか存在しない。

スレッドの増加: 複数スレッドを持つためには、プログラム内で明示的にスレッドを作成する必要がある、


スレッド作成関数はOSやプログラミング言語で異なる。

POSIX ...pthread_create()
C++... std::thread
など

